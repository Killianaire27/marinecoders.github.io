<html>

<head>
    <script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    <script src="../assets/js/naval_letter.js"></script>

    <!-- Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
</head>

<body style="background-color:#3b3b3b;">
    <div class="container" style="background-color: black">
        
    <img src="../images/Marine_Coders_Logo.jpg" class="img-fluid" alt="Responsive image">

    <h1 text-center>Naval Letter Format Generator</h1>

    <fieldset>
        <legend class="text-white"> File Name Information: </legend>
        <label>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon3">Enter Your Desired Filename:</span>
            <input class="form-control" type="text" name="Filename" size="30" maxlength="30">
                </div>
            </div>
        </label>
        <br />
    </fieldset>
    <br />

    <!-- Destination e-mail address? -->
           
            <!-- Header Information -->
            <fieldset>
                <legend> Header Information: </legend>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">Enter your SSIC:</span>
                    <input class="form-control" type="text" name="SSIC" size="30" maxlength="4">
                    </div>
                </div>
                </label>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">Enter Your Reply Code:</span>
                    <input class="form-control" type="text" name="ReplyCode" size="30" maxlength="10">
                        </div>
                        </div>
                </label>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">Enter The Date (DD Mmm YY):</span>
                    <input class="form-control" type="text" name="Date" size="30" maxlength="9">
                </div>
            </div>
                        </label>
            </fieldset>
            
            <br />
            
            <!-- Reply Information -->
            <fieldset>
                <legend> Reply Block: </legend>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">From (Full Identifier or Billet and Unit Name):</span>
                    <input class="form-control" type="text" name="From" size="60" maxlength="150">
                    </div>
                    </div>
                        </label>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">To (Billet and unit Name or identifier here):</span>
                    <input class="form-control" type="text" name="To" size="60" maxlength="150">
                        </div>
                        </div>
                        </label>
                <label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="basic-addon3">Enter The Subject (ALWAYS IN ALL CAPS):</span>
                    <input class="form-control" type="text" name="Subj" size="60" maxlength="150">
                    </div>
                    </div>
                </label>
            </fieldset>
            
            <br />
            
            <!-- Optional Portions -->
            <fieldset>
                <legend> Optional Items: </legend>
                
		<label>Do you have a VIA?</label>
  		<input type="radio" name="ifVia" id="rad1" value="yes" onclick="ShowHideDiv('rad1','ViaTextBoxContainer')"> Yes </label>
		<input type="radio" name="ifVia" checked="checked" id="rad2" value="no" onclick="ShowHideDiv('rad1','ViaTextBoxContainer')"> No</label>

		<div style="display: none;" class="label" id="ViaTextBoxContainer">
		<label>
            Enter The Via (Title, name of activity (Code), location when needed):
        </label>
		<input id="btnAdd" type="button" value="Add Via" onclick="AddViaTextBox()" />
		<input class="form-control" name = "ViaTextBox" size="60" type="text"/>

		</br>
		</div>

</br>
		<label>Do you have References ?</label>
  		<input type="radio" name="ifRef" id="rad3" value="yes" onclick="ShowHideDiv('rad3','RefTextBoxContainer')"> Yes </label>
		<input type="radio" name="ifRef" checked="checked" id="rad4" value="no" onclick="ShowHideDiv('rad3','RefTextBoxContainer')"> No</label>

		<div style="display: none;" class="label" id="RefTextBoxContainer">
                    <label>
                        Enter The References (ALWAYS IN CAPS, ABBREVIATIONS ALLOWED):
            <input id="btnAdd" type="button" value="Add Ref" onclick="AddRefTextBox()" />
		<input class="form-control" name = "RefTextBox" size="60" type="text"/>

		</br>
		</div>
                <br />
     
		<label>Do you have Enclosures?</label>
  		<input type="radio" name="ifEncl" id="rad5" value="yes" onclick="ShowHideDiv('rad5','EnclTextBoxContainer')"> Yes </label>
		<input type="radio" name="ifEncl" checked="checked" id="rad6" value="no" onclick="ShowHideDiv('rad5','EnclTextBoxContainer')"> No</label>

		<div style="display: none;" class="label" id="EnclTextBoxContainer">
                <label>
                   Enter The Enclosures (ALWAYS IN CAPS, ABBREVIATIONS ALLOWED):
		<input id="btnAdd" type="button" value="Add Encl" onclick="AddEnclTextBox()" />
		<input class="form-control" name = "EnclTextBox" size="60" type="text"/>

		</br>
		</div>
                <br />
         
            </fieldset>
            
            <br />
            
            <!-- Body of the message -->
            <fieldset>
                <legend> Body Block: </legend>
                
                <div>
                <label for = "body">
                    Enter a body paragraph:
                </label>
                </div>

       		<div class="label" id="BodyTextBoxContainer">
                <textarea class="form-control" rows = "8" cols = "40" id="BodyBlocks" name="BodyBlocks">
                </textarea>
		            
	<label for = "bodylvl">
                    Select the body level:
                </label>
	<select id="BodyLevel" name="BodyLevel" >
	<option SELECTED value=1>1</option>
	<option value=2>2</option>
	<option value=3>3</option>
	</select>   
<!--
	<textarea rows = "8" cols = "80" id="BodyBlocks" name="BodyBlocks" value = "' + value + '" > 
	</textarea>
  	<label for = "bodylvl"> Select the body level: </label>
	<select id="BodyLevel" name="BodyLevel" >
	<option SELECTED value=1>1</option>
	<option value=2>2</option>
	<option value=3>3</option>
	</select>
	<input type="button" value="Remove Paragraph" onclick = "RemoveBodyTextBox(this)" >  
-->
		</br>
		</div>
		</br>
<input id="btnAdd" type="button" value="Add Another Body Paragraph" onclick="AddBodyTextBox()" /> 
                <br />

</fieldset>

<br />

<fieldset>
                <legend> Closing Block: </legend>
		</br>
                <div>
                <label>
                    Enter The Signature (FI. MI. LNAME):
                    <input class="form-control" type="text" name="Sig" size="60" maxlength="150">
                </label>
                </div>
                

</br>
<label>Do you have Copy To?</label>
  		<input type="radio" name="ifCopy" id="rad7" value="yes" onclick="ShowHideDiv('rad7','CopyTextBoxContainer')"> Yes </label>
		<input type="radio" name="ifCopy" checked="checked" id="rad8" value="no" onclick="ShowHideDiv('rad7','CopyTextBoxContainer')"> No</label>

		<div style="display: none;" class="label" id="CopyTextBoxContainer">
                <label>
                   Enter An Adressee (Billet and unit Name or identifier here):
		<input id="btnAdd" type="button" value="Add Copy To" onclick="AddCopyTextBox()" />
		<input class="form-control" name = "CopyTextBox" size="60" type="text"/>
		</br>
		</div>
                <br />

            </fieldset>
            <br />

    <button type="button" onclick="generate()">Click to generate document</button>

    <script>
        function generate() {
            const doc = new docx.Document();
            
            doc.addSection({
                properties: {},
                children: [
                    new docx.Paragraph({
                        children: [
                            new docx.TextRun("Hello World"),
                            new docx.TextRun({
                                text: document.getElementById("title").value,
                                bold: true,
                            }),
                            new docx.TextRun({
                                text: "\tGithub is the best",
                                bold: true,
                            }),
                        ],
                    }),
                ],
            });

            docx.Packer.toBlob(doc).then(blob => {
                console.log(blob);
                saveAs(blob, "example.docx");
                console.log("Document created successfully");
            });
        }
    </script>
</div>
</body>

</html>
