<html>

<head>
    <script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    <script src="../assets/js/naval_letter.js"></script>
</head>

<body>

    <h1>DOCX browser Word document generation</h1>

    <fieldset>
        <legend> File Name Information: </legend>
        <label>
            Enter Your Desired Filename:
            <input type="text" name="Filename" size="30" maxlength="30">
        </label>
        <br />
    </fieldset>
    <br />

    <!-- Destination e-mail address? -->
           
            <!-- Header Information -->
            <fieldset>
                <legend> Header Information: </legend>
                <label>
                    Enter Your SSIC:
                    <input type="text" name="SSIC" size="30" maxlength="4">
                </label>
                <br />
                <label>
                    Enter Your Reply Code:
                    <input type="text" name="ReplyCode" size="30" maxlength="10">
                </label>
                <br />
                <label>
                    Enter The Date (DD Mmm YY):
                    <input type="text" name="Date" size="30" maxlength="9">
                        </label>
            </fieldset>
            
            <br />
            
            <!-- Reply Information -->
            <fieldset>
                <legend> Reply Block: </legend>
                <label>
                    From (Full Identifier or Billet and Unit Name):
                    <input type="text" name="From" size="60" maxlength="150">
                        </label>
                <br />
                <label>
                    To (Billet and unit Name or identifier here):
                    <input type="text" name="To" size="60" maxlength="150">
                        </label>
                <br />
                <label>
                    Enter The Subject (ALWAYS IN ALL CAPS):
                    <input type="text" name="Subj" size="60" maxlength="150">
                </label>
            </fieldset>
            
            <br />
            
            <!-- Optional Portions -->
            <fieldset>
                <legend> Optional Items: </legend>
                
		<label>Do you have a VIA?</label>
  		<input type="radio" name="ifVia" id="rad1" value="yes" onclick="ShowHideDiv()"> Yes </label>
		<input type="radio" name="ifVia" checked="checked" id="rad2" value="no" onclick="ShowHideDiv()"> No</label>

		<div style="display: none;" class="label" id="ViaTextBoxContainer">
		<label>
            Enter The Via (Title, name of activity (Code), location when needed):
        </label>
		<input id="btnAdd" type="button" value="Add Via" onclick="AddViaTextBox()" />
		<input name = "ViaTextBox" size="60" type="text"/>

		</br>
		</div>

</br>
		<label>Do you have References ?</label>
  		<input type="radio" name="ifRef" id="rad3" value="yes"> Yes </label>
		<input type="radio" name="ifRef" checked="checked" id="rad4" value="no"> No</label>

		<div style="display: none;" class="label" id="RefTextBoxContainer">
                <label>
                    Enter The References (ALWAYS IN CAPS, ABBREVIATIONS ALLOWED):
		<input id="btnAdd" type="button" value="Add Ref" onclick="AddRefTextBox()" />
		<input name = "RefTextBox" size="60" type="text"/>

		</br>
		</div>
                <br />
     
		<label>Do you have Enclosures?</label>
  		<input type="radio" name="ifEncl" id="rad5" value="yes"> Yes </label>
		<input type="radio" name="ifEncl" checked="checked" id="rad6" value="no"> No</label>

		<div style="display: none;" class="label" id="EnclTextBoxContainer">
                <label>
                   Enter The Enclosures (ALWAYS IN CAPS, ABBREVIATIONS ALLOWED):
		<input id="btnAdd" type="button" value="Add Encl" onclick="AddEnclTextBox()" />
		<input name = "EnclTextBox" size="60" type="text"/>

		</br>
		</div>
                <br />
         
            </fieldset>
            
            <br />
            
            <!-- Body of the message -->
            <fieldset>
                <legend> Body Block: </legend>
                
                <div>
                <label for = "body">
                    Enter a body paragraph:
                </label>
                </div>

       		<div class="label" id="BodyTextBoxContainer">
                <textarea rows = "8" cols = "80" id="BodyBlocks" name="BodyBlocks">
                </textarea>
		            
	<label for = "bodylvl">
                    Select the body level:
                </label>
	<select id="BodyLevel" name="BodyLevel" >
	<option SELECTED value=1>1</option>
	<option value=2>2</option>
	<option value=3>3</option>
	</select>   
<!--
	<textarea rows = "8" cols = "80" id="BodyBlocks" name="BodyBlocks" value = "' + value + '" > 
	</textarea>
  	<label for = "bodylvl"> Select the body level: </label>
	<select id="BodyLevel" name="BodyLevel" >
	<option SELECTED value=1>1</option>
	<option value=2>2</option>
	<option value=3>3</option>
	</select>
	<input type="button" value="Remove Paragraph" onclick = "RemoveBodyTextBox(this)" >  
-->
		</br>
		</div>
		</br>
<input id="btnAdd" type="button" value="Add Another Body Paragraph" onclick="AddBodyTextBox()" /> 
                <br />

</fieldset>

<br />

<fieldset>
                <legend> Closing Block: </legend>
		</br>
                <div>
                <label>
                    Enter The Signature (FI. MI. LNAME):
                    <input type="text" name="Sig" size="60" maxlength="150">
                </label>
                </div>
                

</br>
<label>Do you have Copy To?</label>
  		<input type="radio" name="ifCopy" id="rad7" value="yes"> Yes </label>
		<input type="radio" name="ifCopy" checked="checked" id="rad8" value="no"> No</label>

		<div style="display: none;" class="label" id="CopyTextBoxContainer">
                <label>
                   Enter An Adressee (Billet and unit Name or identifier here):
		<input id="btnAdd" type="button" value="Add Copy To" onclick="AddCopyTextBox()" />
		<input name = "CopyTextBox" size="60" type="text"/>
		</br>
		</div>
                <br />

            </fieldset>
            <br />

    <button type="button" onclick="generate()">Click to generate document</button>

    <script>
        function generate() {
            const doc = new docx.Document();
            
            doc.addSection({
                properties: {},
                children: [
                    new docx.Paragraph({
                        children: [
                            new docx.TextRun("Hello World"),
                            new docx.TextRun({
                                text: document.getElementById("title").value,
                                bold: true,
                            }),
                            new docx.TextRun({
                                text: "\tGithub is the best",
                                bold: true,
                            }),
                        ],
                    }),
                ],
            });

            docx.Packer.toBlob(doc).then(blob => {
                console.log(blob);
                saveAs(blob, "example.docx");
                console.log("Document created successfully");
            });
        }
    </script>

</body>

</html>
